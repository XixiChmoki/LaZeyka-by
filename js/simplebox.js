var simplebox=function(){var o,m,l,a,y,d,h,r,v,w,x,b,B,s,p,c,f=null,C=!1,e=1,u=20,k=new Image,g={style:{}},M=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,E=/[^\.]\.(swf)\s*$/i,S=[],I={padding:10,margin:20,width:560,height:340,cyclic:!1,overlayShow:!0,hideOnOverlayClick:!0,hideOnContentClick:!1,swf:{wmode:"opaque"},h5video:{controls:"controls",preload:"metadata",autoplay:!1},flashPlayer:"http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf",titlePosition:"inside",titleShow:!0,titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:500,speedOut:500,changeSpeed:500,changeFade:500,scrolling:"auto",autoScale:!0,autoDimension:!0,enableCenter:!0,enableMouseWheel:!0,showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,overlayColor:"#666",overlayOpacity:"0.3",preloadIndent:1};function O(){y.style.display="none",k.onerror=k.onload=null}function n(){C||(C=!0,O(),C=!1)}function H(){simplebox.start({content:"Sorry! the request cann't be reached"},{transitionIn:"none",transitionOut:"none"})}function T(){var e,t=function(){a.innerHTML=m.innerHTML="",Box.fadeOut(o,"fast",function(){C=!1})};C||(C=!0,O(),Box.removeEvent(document,"keydown",q),Box.removeEvent(window,"resize",i),d.style.display="none",h.style.display="none",r.style.display="none",a.style.overflow="hidden",f&&(f.parentNode.removeChild(f),f=null),"fade"==b.transitionOut?Box.fadeOut(l,t):"elastic"==b.transitionOut?(e=p,p=s,s=e,new Animate(g,"fx",{from:0,to:1,step:A,time:b.speedOut,callback:function(){l.style.display="none",t()}})):(l.style.display="none",t()))}function N(){if(!C){C=!0,O(),b=Box.extend({},x);var e,t,l,i,n=v[w],o=b.orig;if("string"==typeof o&&(o=document.querySelector(o)),n.getElementsByTagName&&!o&&(b.orig=o=n.getElementsByTagName("img")[0]),b.title=n.title||o&&(o.title||o.alt)||"",e=b.href||n.href||null,b.type)"html"==(t=b.type)&&(e=b.content);else if(e&&(e.match(M)?t="image":e.match(E)&&(t="swf")),void 0!==b.content)t="html",e=b.content;else if((l=b.video)&&(i=l.split(";"))&&0<i.length){var a,d={mp4:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',webm:'video/webm; codecs="vp8, vorbis"',ogv:'video/ogg; codecs="theora, vorbis"',ogg:'video/ogg; codecs="theora, vorbis"'},h=[],r=null;t="h5video",a=document.createElement("video"),document.body.appendChild(a),i.forEach(function(e,t,i){var n,o=e.slice(-3);if("flv"!=o&&(l=d[o])){if("mp4"==o&&(h.push(e),!a.play))return void h.push(e);"probably"!=(n=a.canPlayType(l))&&"maybe"!=n||r||(r='<source src="'+e+"\" type='"+l+"'>")}else h.push(e)}),0<h.length&&(e=h[0]),r&&(e=r)}if(e&&t){b.href=e;var s,p,c,f,u="",g="";switch(b.type=t){case"image":C=!1,clearInterval(B),y.style.display="block",B=setInterval($,66),(k=new Image).onload=function(){k.onerror=null,k.onload=null,C=!0,m.innerHTML="",b.width=k.width,b.height=k.height,k.alt=b.title,k.id="simple-img",m.appendChild(k),L()},k.onerror=H,k.src=e;break;case"h5video":if(a.play&&r){for(s in u+='<video id="simple-video" ',b.h5video)u+=s+"="+b.h5video[s]+" ";u+='width="'+b.width+'" height="'+b.height+'">',u+=r,u+="</video>",m.innerHTML=u,document.body.removeChild(a),L();break}0<h.length&&(document.body.removeChild(a),b.swf.flashvars=(c=(f={}).playlist=[],(p=b.h5video.poster)&&c.push(p),(p={}).url=b.href,p.autoPlay=b.h5video.autoplay,p.autoBuffering="none"!==b.h5video.preload,c.push(p),"config="+JSON.stringify(f)),b.href=b.flashPlayer);case"swf":for(s in u+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+b.width+'" height="'+b.height+'"><param name="movie" value="'+b.href+'"></param>',b.swf)u+='<param name="'+s+"\" value='"+b.swf[s]+"'></param>",g+=" "+s+"='"+b.swf[s]+"'";u+='<embed src="'+b.href+'" type="application/x-shockwave-flash" width="'+b.width+'" height="'+b.height+'"'+g+"></embed></object>",m.innerHTML=u,L();break;case"html":m.innerHTML=b.href,b.autoDimension&&(Box.extend(m.style,{display:"block",position:"absolute"}),b.width=parseInt(Box.getComputedStyleValue(m,"width")),b.height=parseInt(Box.getComputedStyleValue(m,"height")),Box.extend(m.style,{display:"none",position:"auto"})),L()}}else C=!1}}function L(){var e,t,i,n=b.fadeSpeed;if(y.style.display="none",i=Box.extend({},p),p=W(),function(){var e,t=b.title,i=b.padding;f&&(f.parentNode.removeChild(f),f=null);if(c=0,!b.titleShow)return;if(!t)return;switch(t="function"==typeof b.titleFormat?b.titleFormat(t,v,w,b):function(e){var t=!1;if(e&&e.length)switch(b.titlePosition){case"over":t='<span id="simple-title-over">'+e+"</span>";break;default:t=e}return t}(t),e=Math.max(p.width-2*i,1),f=Box.createElement("div",{id:"simple-title",innerHTML:t,className:"simple-title-"+b.titlePosition}),Box.extend(f.style,{width:e+"px",paddingLeft:i+"px",paddingRight:i+"px"}),document.body.appendChild(f),b.titlePosition){case"over":f.style.bottom=i+"px";break;default:c=f.offsetHeight-b.padding,p.height+=c}l.appendChild(f),f.style.display="none"}(),e=p.width-2*b.padding,t=p.height-2*b.padding-c,"none"!=Box.getComputedStyleValue(l,"display"))return d.style.display="none",h.style.display="none",r.style.display="none",void Box.fadeOut(a,n,function(){if(a.style.overflow="hidden",a.innerHTML=m.innerHTML,(s={width:parseInt(a.style.width),height:parseInt(a.style.height)}).width==e&&s.height==t)Box.fadeIn(a,n,function(){Box.extendStyle(l,p),D()});else{s=i,new Animate(g,"fx",{from:0,to:1,time:b.changeSpeed,step:A,callback:function(e){Box.fadeIn(a,n,D)}})}});s=F(),a.innerHTML=m.innerHTML,b.overlayShow&&(o.style.backgroundColor=b.overlayColor,o.style.opacity=b.overlayOpacity,o.style.display="block"),"elastic"==b.transitionIn?(Box.extend(a.style,{top:b.padding+"px",left:b.padding+"px",width:Math.max(s.width-2*b.padding,1)+"px",height:Math.max(s.height-2*b.padding,1)+"px"}),Box.extendStyle(l,s),l.style.opacity=1,l.style.display="block",new Animate(g,"fx",{from:0,to:1,step:A,time:b.speedIn,callback:D})):(Box.extendStyle(l,p),Box.extend(a.style,{top:b.padding+"px",left:b.padding+"px",width:Math.max(p.width-2*b.padding,1)+"px",height:Math.max(p.height-2*b.padding-c,1)+"px"}),"fade"==b.transitionIn?Box.fadeIn(l,n,D):(l.style.opacity=1,l.style.display="block",D()))}function D(){var e=b.scrolling;e="auto"==e?"html"==b.type?"auto":"hidden":"yes"==e?"auto":"visible",a.style.overflow=e,f&&(f.style.display="block"),b.showCloseButton&&(d.style.display="block"),b.hideOnContentClick&&(Box.removeEvent(a,"click",T),Box.addEvent(a,"click",T)),b.hideOnOverlayClick&&b.overlayShow&&(Box.removeEvent(o,"click",T),Box.addEvent(o,"click",T)),1<v.length&&function(){var e=navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel";Box.addEvent(document,"keydown",q),b.enableMouseWheel&&(Box.removeEvent(l,e,t),Box.addEvent(l,e,t));if(!b.showNavArrows)return;(b.cyclic&&1<v.length||0!=w)&&(h.style.display="block");(b.cyclic&&1<v.length||w!=v.length-1)&&(r.style.display="block")}(),b.enableCenter&&Box.addEvent(window,"resize",i),C=!1,function(){var e,t,i,n,o=v.length;for(e=w+1,t=w+b.preloadIndent;e<=t&&!(o-1<e);++e)void 0!==(n=v[e].href)&&!S[e]&&n.match(M)&&((i=new Image).src=v[e].href,S[e]=i);for(e=t+1;e<o-1;++e)delete S[e];for(e=w-1,t=w-b.preloadIndent;t<=e&&!(e<0);e--)void 0!==(n=v[e].href)&&!S[e]&&n.match(M)&&((i=new Image).src=v[e].href,S[e]=i);for(e=0;e<t;++e)delete S[e]}()}function A(e){var t=Math.round(s.width+(p.width-s.width)*e),i=Math.round(s.height+(p.height-s.height)*e),n=Math.round(s.top+(p.top-s.top)*e),o=Math.round(s.left+(p.left-s.left)*e);Box.extendStyle(l,{width:t,height:i,left:o,top:n}),t=Math.max(t-2*b.padding,0),i=Math.max(i-(2*b.padding+c*e),0),a.style.width=t+"px",a.style.height=i+"px"}function P(){var e,t=(e=document.documentElement,{width:window.innerWidth||e&&e.clientWidth||document.body.clientWidth,height:window.innerHeight||e&&e.clientHeight||document.body.clientHeight});return[t.width,t.height,document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]}function F(){var e,t,i=b.orig,n=b.padding;return i?{width:(e=function(e){var t,i,n=0,o=0;for(t=e.offsetHeight,i=e.offsetWidth;o+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{width:i,height:t,left:o,top:n}}(i)).width+2*n,height:e.height+2*n,top:e.top-n,left:e.left-n}:{width:1,height:1,top:(t=P())[3]+.5*t[1],left:t[2]+.5*t[0]}}function W(){var e=P(),t={},i=b.margin,n=b.autoScale,o=2*b.padding,l=2*(b.margin+u),a=2*(b.margin+u);if(-1<b.width.toString().indexOf("%")?(t.width=e[0]*parseFloat(b.width)/100-2*u,n=!1):t.width=b.width+o,-1<b.height.toString().indexOf("%")?(t.height=e[1]*parseFloat(b.height)/100-2*u,n=!1):t.height=b.height+o,n&&(t.width>e[0]-l||t.height>e[1]-a))if("image"==b.type){l+=o,a+=o;var d=Math.min(Math.min(e[0]-l,b.width)/b.width,Math.min(e[1]-a,b.height)/b.height);t.width=Math.round(d*(t.width-o))+o,t.height=Math.round(d*(t.height-o))+o}else t.width=Math.min(t.width,e[0]-l),t.height=Math.min(t.height,e[1]-a);return t.left=e[2]+.5*(e[0]-t.width),t.top=e[3]+.5*(e[1]-t.height),0==b.autoScale&&(t.top=Math.max(e[3]+i,t.top),t.left=Math.max(e[2]+i,t.left)),t}function t(e){((e=e||window.event).wheelDelta?e.wheelDelta/120:-e.detail/3)<0?V():j(),e.preventDefault()}function i(){console.log(P()),s=F(),p=W(),f&&(f.style.width=p.width-2*b.padding+"px","inside"==b.titlePosition&&(c=f.offsetHeight-b.padding,p.height+=c)),Box.extendStyle(l,p),Box.extend(a.style,{top:b.padding+"px",left:b.padding+"px",width:Math.max(p.width-2*b.padding,1)+"px",height:Math.max(p.height-2*b.padding-c,1)+"px"})}function q(e){e||window.event;27==e.keyCode&&b.enableEscapeButton?(e.preventDefault(),T()):37==e.keyCode?(e.preventDefault(),j()):39==e.keyCode&&(e.preventDefault(),V())}function j(){return z(w-1)}function V(){return z(w+1)}function z(e){C||(-1<e&&v.length>e&&(w=e,N()),b.cyclic&&1<v.length&&e<0&&(w=v.length-1,N()),b.cyclic&&1<v.length&&e>=v.length&&(w=0,N()))}function $(){"block"==y.style.display?(y.childNodes[0].style.top=-40*e+"px",e=(e+1)%12):clearInterval(B)}return{init:function(){var e=document.createDocumentFragment(),t=Box.createElement("div",{id:"simplebox"});e.appendChild(t),m=Box.createElement("div",{id:"simple-tmp"}),t.appendChild(m),(y=m.cloneNode(!1)).id="simple-loading",y.appendChild(document.createElement("div")),t.appendChild(y),(o=m.cloneNode(!1)).id="simple-overlay",t.appendChild(o),(l=m.cloneNode(!1)).id="simple-outer",t.appendChild(l),(a=m.cloneNode(!1)).id="simple-inner",l.appendChild(a),d=Box.createElement("a",{id:"simple-close"}),l.appendChild(d),h=Box.createElement("a",{id:"simple-left"});var i=Box.createElement("span",{id:"simple-left-ico",className:"simple-ico"});h.appendChild(i),l.appendChild(h),(r=h.cloneNode(!0)).id="simple-right",r.querySelector("span").id="simple-right-ico",l.appendChild(r),document.body.appendChild(e),Box.addEvent(d,"click",T),Box.addEvent(h,"click",j),Box.addEvent(r,"click",V),Box.addEvent(y,"click",n)},start:function(s,p,e){var t;if(t="string"==typeof s?(t=document.querySelectorAll(s),Array.prototype.slice.call(t,0)):!Array.isArray(s)&&[s],2==arguments.length&&"boolean"==typeof p&&(e=p,p=null),0!=t.length){if(e)return s=t[0],void o(0,t);t.forEach(function(t,i,n){Box.addEvent(t,"click",function(e){s=t,e.preventDefault(),o(i,n)})})}function o(e,t){v=t,w=e,x=Box.extend({},I);var i,n,o=s.attributes;if(o)for(var l=0,a=o.length;l<a;++l)if(0==(i=o[l].nodeName).indexOf("data-")){n=(i=i.split("-")).pop();for(var d=1,h=i.length,r=x;d<h;++d)r[i[d]]&&(r=r[i[d]]);r[n]=o[l].nodeValue}p&&Box.extend(x,p),x.width=parseInt(x.width),x.height=parseInt(x.height),N()}}}}();